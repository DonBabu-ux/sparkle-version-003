<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sparkle â€¢ <%= pageTitle || 'Help Center' %></title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/style.css">
    <style>
        <%- include('styles/help-center.css') %>
        
        /* Import About Page Variables */
        :root {
            --sparkle-pink: #ff4d94;
            --sparkle-pink-light: #ff7eb3;
            --sparkle-pink-lighter: #ffc2d6;
            --sparkle-dark: #1a1a2e;
            --sparkle-gray: #f5f5f7;
            --sparkle-border: #e0e0e0;
            --gradient: linear-gradient(135deg, var(--sparkle-pink) 0%, var(--sparkle-pink-light) 100%);
            --shadow: 0 8px 30px rgba(255, 77, 148, 0.12);
        }

        /* Navigation Bar */
        .main-nav {
            background: white;
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.08);
            padding: 0 20px;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 70px;
        }

        .nav-brand {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
        }

        .brand-logo {
            font-size: 28px;
            color: var(--sparkle-pink);
        }

        .brand-text {
            font-size: 1.5rem;
            font-weight: 700;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .nav-links {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .nav-link {
            padding: 10px 20px;
            text-decoration: none;
            color: #555;
            font-weight: 500;
            border-radius: 25px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-link:hover {
            color: var(--sparkle-pink);
            background: var(--sparkle-gray);
        }

        .nav-link.active {
            background: var(--gradient);
            color: white;
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--gradient);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            text-decoration: none;
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--sparkle-pink);
            cursor: pointer;
        }

        /* Main Layout */
        .main-content {
            min-height: calc(100vh - 70px);
            background: linear-gradient(135deg, #f5f7fa 0%, #f0f2f5 100%);
            padding: 30px 20px;
        }

        /* Help Center Specific */
        .help-header {
            background: var(--gradient);
            color: white;
            padding: 4rem 2rem;
            text-align: center;
            border-radius: 0 0 30px 30px;
            margin-bottom: 3rem;
            position: relative;
            overflow: hidden;
        }

        .help-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23ffffff' fill-opacity='0.1' fill-rule='evenodd'/%3E%3C/svg%3E");
        }

        .help-header h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
            position: relative;
        }

        /* Explore Campus Page Styles */
        .explore-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        .explore-header {
            text-align: center;
            margin-bottom: 50px;
        }

        .explore-header h1 {
            font-size: 2.8rem;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
        }

        .search-section {
            max-width: 600px;
            margin: 40px auto;
        }

        .search-box {
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 18px 25px 18px 55px;
            border: 2px solid var(--sparkle-border);
            border-radius: 50px;
            font-size: 1.1rem;
            transition: all 0.3s;
            background: white;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--sparkle-pink);
            box-shadow: 0 5px 20px rgba(255, 77, 148, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 25px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--sparkle-pink);
            font-size: 1.2rem;
        }

        .campus-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }

        .campus-card {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            border: 1px solid var(--sparkle-border);
        }

        .campus-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(255, 77, 148, 0.15);
            border-color: var(--sparkle-pink);
        }

        .campus-image {
            height: 200px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            position: relative;
            overflow: hidden;
        }

        .campus-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .campus-badge {
            position: absolute;
            top: 20px;
            right: 20px;
            background: var(--gradient);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .campus-content {
            padding: 25px;
        }

        .campus-content h3 {
            color: var(--sparkle-dark);
            margin-bottom: 10px;
            font-size: 1.4rem;
        }

        .campus-stats {
            display: flex;
            gap: 20px;
            margin: 15px 0;
            padding: 15px 0;
            border-top: 1px solid var(--sparkle-border);
            border-bottom: 1px solid var(--sparkle-border);
        }

        .stat {
            text-align: center;
            flex: 1;
        }

        .stat-number {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--sparkle-pink);
        }

        .stat-label {
            font-size: 0.85rem;
            color: #666;
            margin-top: 5px;
        }

        .connect-btn {
            width: 100%;
            padding: 14px;
            background: var(--gradient);
            color: white;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-top: 15px;
        }

        .connect-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(255, 77, 148, 0.3);
        }

        .connect-btn.connected {
            background: #4CAF50;
        }

        /* Footer */
        .main-footer {
            background: var(--sparkle-dark);
            color: white;
            padding: 60px 20px 30px;
            margin-top: 80px;
        }

        .footer-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .footer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }

        .footer-section h4 {
            color: white;
            margin-bottom: 20px;
            font-size: 1.2rem;
            position: relative;
            padding-bottom: 10px;
        }

        .footer-section h4::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: 0;
            width: 40px;
            height: 3px;
            background: var(--gradient);
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 12px;
        }

        .footer-links a {
            color: #ccc;
            text-decoration: none;
            transition: color 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .footer-links a:hover {
            color: var(--sparkle-pink);
        }

        .footer-bottom {
            text-align: center;
            padding-top: 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: #999;
            font-size: 0.9rem;
        }

        .social-links {
            display: flex;
            gap: 15px;
            margin: 20px 0;
        }

        .social-link {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            text-decoration: none;
            transition: all 0.3s;
        }

        .social-link:hover {
            background: var(--gradient);
            transform: translateY(-3px);
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .nav-container {
                padding: 0 15px;
            }
            
            .nav-links {
                display: none;
                position: absolute;
                top: 70px;
                left: 0;
                right: 0;
                background: white;
                flex-direction: column;
                padding: 20px;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
                border-radius: 0 0 20px 20px;
            }
            
            .nav-links.active {
                display: flex;
            }
            
            .mobile-menu-btn {
                display: block;
            }
            
            .help-header h1 {
                font-size: 2.2rem;
            }
            
            .campus-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .main-content {
                padding: 20px 15px;
            }
            
            .help-header {
                padding: 3rem 1rem;
            }
            
            .explore-header h1 {
                font-size: 2.2rem;
            }
            
            .campus-stats {
                flex-wrap: wrap;
            }
            
            .stat {
                min-width: 45%;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="main-nav">
        <div class="nav-container">
            <a href="/" class="nav-brand">
                <i class="fas fa-sparkles brand-logo"></i>
                <span class="brand-text">Sparkle</span>
            </a>

            <button class="mobile-menu-btn" onclick="toggleMobileMenu()">
                <i class="fas fa-bars"></i>
            </button>

            <div class="nav-links" id="navLinks">
                <a href="/dashboard" class="nav-link <%= currentPage === 'dashboard' ? 'active' : '' %>">
                    <i class="fas fa-home"></i> Dashboard
                </a>
                <a href="/connect" class="nav-link <%= currentPage === 'connect' ? 'active' : '' %>">
                    <i class="fas fa-compass"></i> Explore Campus
                </a>
                <a href="/help" class="nav-link <%= currentPage === 'help' ? 'active' : '' %>">
                    <i class="fas fa-headset"></i> Help Center
                </a>
                <a href="/about" class="nav-link <%= currentPage === 'about' ? 'active' : '' %>">
                    <i class="fas fa-info-circle"></i> About
                </a>
                
                <% if (user && user.role === 'admin') { %>
                <a href="/admin" class="nav-link <%= currentPage === 'admin' ? 'active' : '' %>">
                    <i class="fas fa-cog"></i> Admin
                </a>
                <% } %>
            </div>

            <div class="user-menu">
                <% if (user) { %>
                    <a href="/profile/<%= user.username %>" class="user-avatar" title="Your Profile">
                        <%= user.name ? user.name.charAt(0).toUpperCase() : 'U' %>
                    </a>
                    <a href="/logout" class="nav-link" style="color: #ff4444;">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </a>
                <% } else { %>
                    <a href="/login" class="nav-link">
                        <i class="fas fa-sign-in-alt"></i> Login
                    </a>
                    <a href="/signup" class="nav-link active">
                        <i class="fas fa-user-plus"></i> Sign Up
                    </a>
                <% } %>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="main-content">
        <% if (currentPage === 'help') { %>
            <!-- Help Center Content -->
            <header class="help-header">
                <h1><i class="fas fa-headset"></i> Sparkle Help Center</h1>
                <p>Get instant support, browse FAQs, or chat with our team</p>
            </header>

            <div class="help-container">
                <!-- Quick Actions -->
                <div class="quick-actions">
                    <div class="action-card" onclick="openChat()">
                        <div class="action-icon">
                            <i class="fas fa-comments"></i>
                        </div>
                        <h3>Live Chat Support</h3>
                        <p>Chat instantly with our technical team</p>
                        <small>Average wait time: <span id="wait-time">2 minutes</span></small>
                    </div>

                    <div class="action-card" onclick="showFAQs()">
                        <div class="action-icon">
                            <i class="fas fa-question-circle"></i>
                        </div>
                        <h3>Browse FAQs</h3>
                        <p>Find answers to common questions</p>
                        <small><%= faqCount || '50+' %> questions available</small>
                    </div>

                    <div class="action-card" onclick="createTicket()">
                        <div class="action-icon">
                            <i class="fas fa-ticket-alt"></i>
                        </div>
                        <h3>Submit a Ticket</h3>
                        <p>Get help via email for complex issues</p>
                        <small>Response within 24 hours</small>
                    </div>
                </div>

                <!-- FAQ Section -->
                <div class="faq-section">
                    <h2 class="section-title">
                        <i class="fas fa-book"></i> Frequently Asked Questions
                    </h2>
                    <div class="faq-grid" id="faqContainer">
                        <% if (faqs && faqs.length > 0) { %>
                            <% faqs.forEach(function(faq) { %>
                                <div class="faq-item">
                                    <div class="faq-question" onclick="toggleFAQ(this)">
                                        <%= faq.question %>
                                        <i class="fas fa-chevron-down faq-toggle"></i>
                                    </div>
                                    <div class="faq-answer">
                                        <%= faq.answer %>
                                    </div>
                                </div>
                            <% }); %>
                        <% } else { %>
                            <div class="faq-item">
                                <div class="faq-question" onclick="toggleFAQ(this)">
                                    How do I reset my password?
                                    <i class="fas fa-chevron-down faq-toggle"></i>
                                </div>
                                <div class="faq-answer">
                                    Go to Settings > Account > Security > Change Password. You'll receive an email with reset instructions.
                                </div>
                            </div>
                        <% } %>
                    </div>
                </div>

                <!-- Support Tickets (Only for logged in users) -->
                <% if (user && user.id) { %>
                <div class="tickets-section">
                    <h2 class="section-title">
                        <i class="fas fa-tasks"></i> My Support Tickets
                    </h2>
                    <div id="ticketsContainer">
                        <% if (tickets && tickets.length > 0) { %>
                            <% tickets.forEach(function(ticket) { %>
                                <div class="ticket-item">
                                    <div class="ticket-header">
                                        <strong><%= ticket.subject %></strong>
                                        <span class="ticket-status status-<%= ticket.status %>">
                                            <%= ticket.status.charAt(0).toUpperCase() + ticket.status.slice(1) %>
                                        </span>
                                    </div>
                                    <p>Submitted: <%= ticket.createdAt %> â€¢ Last updated: <%= ticket.updatedAt %></p>
                                </div>
                            <% }); %>
                        <% } else { %>
                            <p>You have no support tickets yet.</p>
                        <% } %>
                    </div>
                    <button class="new-ticket-btn" onclick="createTicket()">
                        <i class="fas fa-plus"></i> New Support Ticket
                    </button>
                </div>
                <% } %>

                <!-- Resource Links -->
                <div class="resources-section">
                    <h2 class="section-title">
                        <i class="fas fa-external-link-alt"></i> Helpful Resources
                    </h2>
                    <div class="resources-grid">
                        <div class="resource-card">
                            <h4><i class="fas fa-graduation-cap"></i> Tutorials & Guides</h4>
                            <ul class="resource-links">
                                <li><a href="#"><i class="fas fa-play-circle"></i> Getting Started Video</a></li>
                                <li><a href="/manual"><i class="fas fa-file-pdf"></i> User Manual (PDF)</a></li>
                                <li><a href="#"><i class="fas fa-blog"></i> Tips & Tricks Blog</a></li>
                            </ul>
                        </div>
                        <div class="resource-card">
                            <h4><i class="fas fa-tools"></i> Troubleshooting</h4>
                            <ul class="resource-links">
                                <li><a href="#"><i class="fas fa-wifi"></i> Connection Issues</a></li>
                                <li><a href="#"><i class="fas fa-upload"></i> Upload Problems</a></li>
                                <li><a href="#"><i class="fas fa-mobile-alt"></i> Mobile App Help</a></li>
                            </ul>
                        </div>
                        <div class="resource-card">
                            <h4><i class="fas fa-shield-alt"></i> Safety & Security</h4>
                            <ul class="resource-links">
                                <li><a href="#/settings"><i class="fas fa-user-shield"></i> Privacy Settings</a></li>
                                <li><a href="#"><i class="fas fa-ban"></i> Report Abuse</a></li>
                                <li><a href="#/settings"><i class="fas fa-lock"></i> Account Security</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

        <% } else if (currentPage === 'connect') { %>
            <!-- Explore Campus Page -->
            <div class="explore-container">
                <div class="explore-header">
                    <h1><i class="fas fa-compass"></i> Explore Campus</h1>
                    <p>Connect with students across <%= stats?.campuses || '100+' %> campuses worldwide</p>
                    
                    <div class="search-section">
                        <div class="search-box">
                            <i class="fas fa-search search-icon"></i>
                            <input type="text" 
                                   class="search-input" 
                                   placeholder="Search campuses, students, or interests..."
                                   id="campusSearch"
                                   onkeyup="searchCampuses()">
                        </div>
                    </div>
                </div>

                <div class="campus-grid" id="campusGrid">
                    <% if (campuses && campuses.length > 0) { %>
                        <% campuses.forEach(function(campus) { %>
                            <div class="campus-card" data-campus-id="<%= campus.id %>">
                                <div class="campus-image">
                                    <% if (campus.image) { %>
                                        <img src="<%= campus.image %>" alt="<%= campus.name %>">
                                    <% } else { %>
                                        <div style="background: linear-gradient(135deg, <%= campus.color || '#667eea' %> 0%, <%= campus.color2 || '#764ba2' %> 100%); 
                                                    height: 100%; 
                                                    display: flex; 
                                                    align-items: center; 
                                                    justify-content: center;">
                                            <i class="fas fa-university" style="font-size: 4rem; color: white; opacity: 0.8;"></i>
                                        </div>
                                    <% } %>
                                    <span class="campus-badge"><%= campus.country %></span>
                                </div>
                                
                                <div class="campus-content">
                                    <h3><%= campus.name %></h3>
                                    <p style="color: #666; line-height: 1.5; margin-bottom: 15px;">
                                        <%= campus.description || 'Join students at this vibrant campus community.' %>
                                    </p>
                                    
                                    <div class="campus-stats">
                                        <div class="stat">
                                            <div class="stat-number"><%= campus.students?.toLocaleString() || '5,000+' %></div>
                                            <div class="stat-label">Students</div>
                                        </div>
                                        <div class="stat">
                                            <div class="stat-number"><%= campus.connections?.toLocaleString() || '10K+' %></div>
                                            <div class="stat-label">Connections</div>
                                        </div>
                                        <div class="stat">
                                            <div class="stat-number"><%= campus.online?.toLocaleString() || '500+' %></div>
                                            <div class="stat-label">Online</div>
                                        </div>
                                    </div>
                                    
                                    <% const isConnected = user?.connectedCampuses?.includes(campus.id); %>
                                    <button class="connect-btn <%= isConnected ? 'connected' : '' %>" 
                                            onclick="toggleCampusConnection('<%= campus.id %>', this)">
                                        <% if (isConnected) { %>
                                            <i class="fas fa-check-circle"></i> Connected
                                        <% } else { %>
                                            <i class="fas fa-link"></i> Connect with Campus
                                        <% } %>
                                    </button>
                                </div>
                            </div>
                        <% }); %>
                    <% } else { %>
                        <!-- Default Campuses -->
                        <div class="campus-card">
                            <div class="campus-image">
                                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); height: 100%;"></div>
                                <span class="campus-badge">USA</span>
                            </div>
                            <div class="campus-content">
                                <h3>Stanford University</h3>
                                <p>Connect with 17,000+ students at Stanford's vibrant campus community.</p>
                                <div class="campus-stats">
                                    <div class="stat">
                                        <div class="stat-number">17K+</div>
                                        <div class="stat-label">Students</div>
                                    </div>
                                    <div class="stat">
                                        <div class="stat-number">45K+</div>
                                        <div class="stat-label">Connections</div>
                                    </div>
                                    <div class="stat">
                                        <div class="stat-number">1.2K+</div>
                                        <div class="stat-label">Online</div>
                                    </div>
                                </div>
                                <button class="connect-btn" onclick="connectToCampus(this)">
                                    <i class="fas fa-link"></i> Connect with Campus
                                </button>
                            </div>
                        </div>
                        
                        <div class="campus-card">
                            <div class="campus-image">
                                <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); height: 100%;"></div>
                                <span class="campus-badge">UK</span>
                            </div>
                            <div class="campus-content">
                                <h3>University of Cambridge</h3>
                                <p>Join 23,000+ students in one of the world's oldest universities.</p>
                                <div class="campus-stats">
                                    <div class="stat">
                                        <div class="stat-number">23K+</div>
                                        <div class="stat-label">Students</div>
                                    </div>
                                    <div class="stat">
                                        <div class="stat-number">38K+</div>
                                        <div class="stat-label">Connections</div>
                                    </div>
                                    <div class="stat">
                                        <div class="stat-number">900+</div>
                                        <div class="stat-label">Online</div>
                                    </div>
                                </div>
                                <button class="connect-btn" onclick="connectToCampus(this)">
                                    <i class="fas fa-link"></i> Connect with Campus
                                </button>
                            </div>
                        </div>
                    <% } %>
                </div>
            </div>

        <% } else if (currentPage === 'about') { %>
            <!-- About Page Content -->
            <%- include('pages/about') %>
        <% } %>
    </div>

    <!-- Chat Modal -->
    <div class="chat-modal" id="chatModal">
        <div class="chat-container">
            <div class="chat-header">
                <h3><i class="fas fa-headset"></i> Live Support</h3>
                <button class="close-chat" onclick="closeChat()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="chat-messages" id="chatMessages">
                <div class="message support">
                    <div class="message-content">
                        Hello! I'm Sparky from the support team. How can I help you today? ðŸ˜Š
                    </div>
                    <span class="message-time">Just now</span>
                </div>
            </div>

            <div class="typing-indicator" id="typingIndicator">
                <div class="typing-dots">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
            </div>

            <div class="chat-input-area">
                <input type="text" 
                       class="chat-input" 
                       id="chatInput" 
                       placeholder="Type your message here..."
                       onkeypress="handleChatKeypress(event)">
                <button class="send-button" onclick="sendMessage()">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Main Footer -->
    <footer class="main-footer">
        <div class="footer-container">
            <div class="footer-grid">
                <div class="footer-section">
                    <h4>Sparkle</h4>
                    <p style="color: #ccc; line-height: 1.6; margin-bottom: 20px;">
                        The ultimate campus social experience connecting students worldwide.
                    </p>
                    <div class="social-links">
                        <a href="<%= socialLinks?.twitter || '#' %>" class="social-link"><i class="fab fa-twitter"></i></a>
                        <a href="<%= socialLinks?.instagram || '#' %>" class="social-link"><i class="fab fa-instagram"></i></a>
                        <a href="<%= socialLinks?.linkedin || '#' %>" class="social-link"><i class="fab fa-linkedin"></i></a>
                        <a href="<%= socialLinks?.github || '#' %>" class="social-link"><i class="fab fa-github"></i></a>
                    </div>
                </div>
                
                <div class="footer-section">
                    <h4>Quick Links</h4>
                    <ul class="footer-links">
                        <li><a href="/dashboard"><i class="fas fa-home"></i> Dashboard</a></li>
                        <li><a href="/connect"><i class="fas fa-compass"></i> Explore Campus</a></li>
                        <li><a href="/help"><i class="fas fa-headset"></i> Help Center</a></li>
                        <li><a href="/about"><i class="fas fa-info-circle"></i> About Us</a></li>
                        <li><a href="/blog"><i class="fas fa-blog"></i> Blog</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h4>Support</h4>
                    <ul class="footer-links">
                        <li><a href="/help#faq"><i class="fas fa-question-circle"></i> FAQs</a></li>
                        <li><a href="/contact"><i class="fas fa-envelope"></i> Contact Us</a></li>
                        <li><a href="/privacy"><i class="fas fa-shield-alt"></i> Privacy Policy</a></li>
                        <li><a href="/terms"><i class="fas fa-file-contract"></i> Terms of Service</a></li>
                        <li><a href="/careers"><i class="fas fa-briefcase"></i> Careers</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h4>Contact Info</h4>
                    <ul class="footer-links">
                        <li><i class="fas fa-map-marker-alt"></i> 123 Campus Drive, Edu City</li>
                        <li><i class="fas fa-phone"></i> 1-800-SPARKLE</li>
                        <li><i class="fas fa-envelope"></i> support@sparkle.com</li>
                        <li><i class="fas fa-clock"></i> 24/7 Support Available</li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; <%= new Date().getFullYear() %> Sparkle Campus Network. All rights reserved.</p>
                <p>Made with <i class="fas fa-heart" style="color: var(--sparkle-pink);"></i> for students worldwide</p>
            </div>
        </div>
    </footer>

    <script>
        // Navigation
        function toggleMobileMenu() {
            const navLinks = document.getElementById('navLinks');
            navLinks.classList.toggle('active');
        }

        // EJS Variables
        const currentUser = <%- JSON.stringify(user || {}) %>;
        const isLoggedIn = <%- !!user %>;
        const currentPage = '<%= currentPage || "help" %>';

        // Chat functionality (from help page)
        let chatMessages = [
            {
                type: 'support',
                content: "Hello! I'm Sparky from the support team. How can I help you today? ðŸ˜Š",
                time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
            }
        ];

        function openChat() {
            document.getElementById('chatModal').classList.add('active');
            document.getElementById('chatInput').focus();
            updateChatDisplay();
        }

        function closeChat() {
            document.getElementById('chatModal').classList.remove('active');
        }

        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            chatMessages.push({
                type: 'user',
                content: message,
                time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
            });
            
            input.value = '';
            updateChatDisplay();
            
            document.getElementById('typingIndicator').classList.add('active');
            
            fetch('/api/help/chat', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ 
                    message: message,
                    userId: currentUser.id || null 
                })
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('typingIndicator').classList.remove('active');
                chatMessages.push({
                    type: 'support',
                    content: data.response,
                    time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
                });
                updateChatDisplay();
            })
            .catch(error => {
                console.error('Error:', error);
                document.getElementById('typingIndicator').classList.remove('active');
                chatMessages.push({
                    type: 'support',
                    content: "I understand. Let me connect you with a specialist.",
                    time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
                });
                updateChatDisplay();
            });
        }

        function updateChatDisplay() {
            const container = document.getElementById('chatMessages');
            container.innerHTML = '';
            chatMessages.forEach(msg => {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${msg.type}`;
                messageDiv.innerHTML = `
                    <div class="message-content">${msg.content}</div>
                    <span class="message-time">${msg.time}</span>
                `;
                container.appendChild(messageDiv);
            });
            container.scrollTop = container.scrollHeight;
        }

        function handleChatKeypress(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        }

        // FAQ functionality
        function toggleFAQ(element) {
            const item = element.parentElement;
            item.classList.toggle('active');
        }

        function showFAQs() {
            document.getElementById('faqContainer').scrollIntoView({ behavior: 'smooth' });
        }

        // Support Ticket functionality
        function createTicket() {
            <% if (!user) { %>
                alert('Please login to submit a support ticket');
                window.location.href = '/login?redirect=/help';
                return;
            <% } %>
            
            const subject = prompt('Enter a brief subject for your ticket:');
            if (!subject) return;
            
            const description = prompt('Describe your issue in detail:');
            if (!description) return;
            
            fetch('/api/help/tickets', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ 
                    subject: subject,
                    description: description,
                    userId: currentUser.id 
                })
            })
            .then(response => response.json())
            .then(data => {
                alert(`Ticket #${data.ticketId} created successfully!\n\nWe'll email you at ${currentUser.email} within 24 hours.`);
                const ticketsContainer = document.getElementById('ticketsContainer');
                if (ticketsContainer) {
                    const ticketDiv = document.createElement('div');
                    ticketDiv.className = 'ticket-item';
                    ticketDiv.innerHTML = `
                        <div class="ticket-header">
                            <strong>${subject}</strong>
                            <span class="ticket-status status-open">Open</span>
                        </div>
                        <p>Submitted: Just now â€¢ Reference: #${data.ticketId}</p>
                    `;
                    ticketsContainer.prepend(ticketDiv);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Failed to create ticket. Please try again.');
            });
        }

        // Explore Campus functionality
        function searchCampuses() {
            const searchTerm = document.getElementById('campusSearch').value.toLowerCase();
            const campusCards = document.querySelectorAll('.campus-card');
            
            campusCards.forEach(card => {
                const campusName = card.querySelector('h3').textContent.toLowerCase();
                const campusDesc = card.querySelector('p').textContent.toLowerCase();
                
                if (campusName.includes(searchTerm) || campusDesc.includes(searchTerm)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        function toggleCampusConnection(campusId, button) {
            <% if (!user) { %>
                alert('Please login to connect with campuses');
                window.location.href = '/login?redirect=/connect';
                return;
            <% } %>
            
            const isConnected = button.classList.contains('connected');
            
            fetch('/api/campus/connect', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    campusId: campusId,
                    userId: currentUser.id,
                    connect: !isConnected
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    if (isConnected) {
                        button.classList.remove('connected');
                        button.innerHTML = '<i class="fas fa-link"></i> Connect with Campus';
                        updateCampusStats(campusId, -1);
                    } else {
                        button.classList.add('connected');
                        button.innerHTML = '<i class="fas fa-check-circle"></i> Connected';
                        updateCampusStats(campusId, 1);
                        showConnectionSuccess();
                    }
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Failed to update connection. Please try again.');
            });
        }

        function updateCampusStats(campusId, change) {
            const card = document.querySelector(`[data-campus-id="${campusId}"]`);
            if (card) {
                const statElement = card.querySelector('.stat:nth-child(2) .stat-number');
                if (statElement) {
                    let current = parseInt(statElement.textContent.replace(/[^0-9]/g, '')) || 0;
                    statElement.textContent = (current + change).toLocaleString() + '+';
                }
            }
        }

        function showConnectionSuccess() {
            const successMsg = document.createElement('div');
            successMsg.style.cssText = `
                position: fixed;
                bottom: 20px;
                right: 20px;
                background: var(--gradient);
                color: white;
                padding: 15px 25px;
                border-radius: 12px;
                box-shadow: 0 10px 30px rgba(255, 77, 148, 0.3);
                z-index: 10000;
                animation: slideIn 0.3s ease;
            `;
            successMsg.innerHTML = `
                <i class="fas fa-check-circle"></i>
                Successfully connected to campus!
            `;
            document.body.appendChild(successMsg);
            
            setTimeout(() => {
                successMsg.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => successMsg.remove(), 300);
            }, 3000);
        }

        // Initialize page-specific functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Help Center specific
            if (currentPage === 'help') {
                const waitTimes = ['1 minute', '2 minutes', '3 minutes', 'Less than 5 minutes'];
                document.getElementById('wait-time').textContent = 
                    waitTimes[Math.floor(Math.random() * waitTimes.length)];
            }
            
            // Explore Campus specific
            if (currentPage === 'connect') {
                // Add any campus page initialization here
            }
            
            // Set active nav link
            document.querySelectorAll('.nav-link').forEach(link => {
                if (link.getAttribute('href').includes(currentPage)) {
                    link.classList.add('active');
                }
            });
        });

        // Close chat when clicking outside
        document.getElementById('chatModal')?.addEventListener('click', function(e) {
            if (e.target === this) {
                closeChat();
            }
        });

        // Add animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
